# DeepONet實現：橢圓PDE與反應-擴散方程 (Enhanced Version)

本項目實現了兩個DeepONet應用例子，分別使用高斯隨機場和切比雪夫多項式生成訓練數據來學習偏微分方程算子。**最新版本包含大幅性能改進和更多訓練樣本！**

## 最新改進 🚀

### 版本 2.0 特色
- **大幅增加訓練樣本**：橢圓PDE從1000增至5000樣本，反應-擴散從800增至3000樣本
- **增強網路架構**：隱藏層從100增至150個神經元
- **改進訓練策略**：添加學習率調度、梯度裁剪、早停機制
- **更高解析度**：增加網格點數以提高精度
- **智能數據生成**：更多樣化和高質量的訓練數據
- **詳細性能監控**：全面的訓練統計和可視化

## 項目結構

```
├── elliptic_pde_deeponet.py          # 橢圓PDE算子學習 (5000樣本)
├── reaction_diffusion_deeponet.py    # 反應-擴散算子學習 (3000樣本)
├── requirements.txt                   # 依賴包
└── README.md                         # 說明文件
```

## 性能對比

| 項目 | 舊版本 | 新版本 | 改進 |
|------|--------|--------|------|
| 橢圓PDE訓練樣本 | 1,000 | 5,000 | +400% |
| 反應-擴散訓練樣本 | 800 | 3,000 | +275% |
| 網格解析度 | 50/64點 | 64/80點 | +28%/+25% |
| 網路隱藏層 | 100 | 150 | +50% |
| 訓練Epochs | 2000/3000 | 5000/5000 | +150%/+67% |

## 安裝依賴

```bash
pip install -r requirements.txt
```

## 程式1：橢圓PDE算子學習 (`elliptic_pde_deeponet.py`)

### 數學模型

學習橢圓PDE算子：
```
-∇·(a(x)∇u) = f(x)  in Ω = [0,1]
u = 0  on ∂Ω
```

**算子映射**：a(x) → u(x)

### 特點

- **訓練數據生成**：使用高斯隨機場生成擴散係數 a(x)
- **核函數**：RBF核 `C(x₁,x₂) = σ²exp(-|x₁-x₂|²/(2l²))`
- **PDE求解器**：有限差分法
- **DeepONet架構**：Branch網路編碼 a(x)，Trunk網路編碼位置 x

### 運行方式

```bash
python elliptic_pde_deeponet.py
```

### 輸出

1. **收斂性圖表**：訓練損失的對數和線性尺度圖
2. **測試結果**：5個測試樣本的真實解 vs DeepONet預測
3. **數據特性分析**：
   - 高斯隨機場樣本
   - 協方差矩陣視覺化
   - 輸入-輸出關係

## 程式2：反應-擴散算子學習 (`reaction_diffusion_deeponet.py`)

### 數學模型

學習反應-擴散方程算子：
```
∂u/∂t = D∇²u + f(u)  in Ω = [0,1]
u(x,0) = u₀(x)
```

**算子映射**：u₀(x) → u(x,T)

### 特點

- **訓練數據生成**：使用切比雪夫多項式生成初始條件 u₀(x)
- **反應項**：Fisher方程 `f(u) = ru(1-u)`
- **時間演化**：使用 `scipy.integrate.solve_ivp`
- **DeepONet架構**：Branch網路編碼 u₀(x)，Trunk網路編碼 (x,t)

### 切比雪夫多項式

```
u₀(x) = Σᵢ₌₀ᴺ aᵢTᵢ(x)
```

其中 Tᵢ(x) 是第i階切比雪夫多項式。

### 運行方式

```bash
python reaction_diffusion_deeponet.py
```

### 輸出

1. **收斂性分析**：包括移動平均的多角度損失圖
2. **測試結果**：初始條件、最終解和絕對誤差的比較
3. **時間演化**：展示從t=0到t=T的解的演化過程
4. **數據特性分析**：
   - 切比雪夫多項式樣本
   - 係數分佈
   - 反應項視覺化

## 主要特色

### 1. 完整的DeepONet實現
- Branch-Trunk雙網路架構
- 內積組合機制
- 偏置項處理

### 2. 高品質訓練數據生成
- **高斯隨機場**：物理意義明確的隨機函數
- **切比雪夫多項式**：優秀的函數逼近性質

### 3. 穩健的數值求解器
- **橢圓PDE**：有限差分法 + 稀疏矩陣求解
- **反應-擴散**：時間演化 + RK45積分器

### 4. 全面的可視化
- 訓練收斂性分析
- 測試結果對比
- 數據特性展示
- 誤差分析

## 理論背景

### DeepONet的數學原理

基於算子的萬能逼近定理：
```
G(u)(y) ≈ Σᵢ₌₁ᵖ bᵢ(u) · tᵢ(y) + b₀
```

其中：
- `bᵢ(u)` 是Branch網路的輸出
- `tᵢ(y)` 是Trunk網路的輸出

### 高斯隨機場

協方差函數定義隨機場的統計性質：
```
C(x₁,x₂) = σ²exp(-|x₁-x₂|²/(2l²))
```

### 切比雪夫多項式

遞歸定義：
```
T₀(x) = 1
T₁(x) = x
Tₙ₊₁(x) = 2xTₙ(x) - Tₙ₋₁(x)
```

## 參數調整

### 橢圓PDE程式
- `sigma`：高斯隨機場方差 (影響函數變化幅度)
- `length_scale`：相關長度 (影響函數光滑性)
- `n_train`：訓練樣本數

### 反應-擴散程式  
- `max_degree`：切比雪夫多項式最大階數
- `D`：擴散係數
- `t_final`：最終時間
- `reaction_type`：反應項類型

## 注意事項

1. **計算時間**：訓練數據生成可能需要幾分鐘
2. **內存需求**：大的網格點數會增加內存消耗
3. **收斂性**：反應-擴散方程較難收斂，可能需要調整學習率
4. **數值穩定性**：確保PDE求解器的穩定性

## 擴展建議

1. **更複雜的算子**：Navier-Stokes方程、Maxwell方程
2. **高維問題**：2D/3D空間問題
3. **參數化PDE**：學習參數依賴的算子
4. **時空DeepONet**：處理時間相關的算子 